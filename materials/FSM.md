# Конечные автоматы

Конечный автомат (КА) в теории алгоритмов — математическая абстракция, модель дискретного устройства, имеющего один вход, один выход и в каждый момент времени находящегося в одном состоянии из множества возможных.

При работе на вход КА последовательно поступают входные воздействия, а на выходе КА формирует выходные сигналы. Переход из одного внутреннего состояния КА в другое может происходить не только от внешнего воздействия, но и самопроизвольно.

КА можно использовать для описания алгоритмов, позволяющих решать те или иные задачи, а также для моделирования практически любого процесса. Несколько примеров:

- Логика искусственного интеллекта для игр.
- Синтаксический и лексический анализ.
- Сложные компоненты.

## Тетрис

![Конечный автомат тетриса](../misc/images/tetris-fsm.png)

Данный КА состоит из следующих состояний:

- Старт — состояние, в котором игра ждет, пока игрок нажмет кнопку готовности к игре.
- Спавн — состояние, в которое переходит игра, при создании очередного блока и выбора следующего блока для спавна.
- Перемещение — основное игровое состояние с обработкой ввода от пользователя — поворот блоков / перемещение блоков по горизонтали.
- Сдвиг — состояние, в которое переходит игра после истечения таймера. В нем текущий блок перемещается вниз на один уровень.
- Соединение — состояние, в которое переходит игра, после «соприкосновения» текущего блока с уже упавшими или с землей. Если образуется заполненные линии, то она уничтожается, и остальные блоки смещаются вниз. Если блок остановился в самом верхнем ряду, то игра переходит в состояние «игра окончена».
- Игра окончена.

## Змейка

![Конечный автомат змейки](../misc/images/snake-fsm.jpeg)

Данный КА состоит из следующих состояний:

- Старт — состояние, в котором игра ждет, пока игрок нажмет кнопку готовности к игре.
- Спавн — состояние, в которое переходит игра, при выставлении змейки на начальное место и выставлении яблока относительно него.
- Перемещение — основное игровое состояние с обработкой ввода от пользователя — изменением направления змейки или ускорением.
- Сдвиг — состояние, в которое переходит игра после истечения таймера. В нем змейка сама перемещается на одну клетку.
- Поедание яблока — состояние, в которое переходит игра, когда перед головой змеи оказывается яблоко, в этом состоянии змейка растет на один блок и происходит спавн нового яблока.
- Столкновение — состояние, в которое переходит игра, когда перед головой змеи оказывается стена или другая часть змеи, состояние сразу переходит в «игра окончена».
- Игра окончена.